<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Team Timings</title>
    <link rel="stylesheet" href="https://cdn.rawgit.com/yahoo/pure-release/v0.6.0/pure-min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/yahoo/pure-release/v0.6.0/grids-responsive-min.css">
    <style media="screen">
      #layout {
        margin: 2em;
      }
      .pure-controls {
        margin-top: 1em;
      }
      .pure-button {
        border-radius: 4px;
      }
    </style>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" charset="utf-8"></script>
    <script type="text/javascript">
      $(function() {
        function createContainer() {
          var container = document.createElement('div');
          container.className = 'pure-g';
          return container;
        }

        function createWrapper() {
          var wrapper = document.createElement('div');
          wrapper.className = 'pure-u-1-2 pure-u-md-1-4';
          return wrapper;
        }

        function createLabelInput() {
          var labelInput = document.createElement('input');
          labelInput.className = 'pure-input-1';
          labelInput.type = 'text';
          labelInput.name = 'baseLabels[]';
          labelInput.placeholder = 'Base Label';
          labelInput.required = true;
          return labelInput;
        }

        function createTimeInput() {
          var timeInput = document.createElement('input');
          timeInput.className = 'pure-input-1-2';
          timeInput.type = 'text';
          timeInput.name = 'journeyTimes[]';
          timeInput.placeholder = '0:25:00';
          timeInput.pattern = '(\d+:)?\d\d?:\d\d';
          timeInput.required = true;
          return timeInput;
        }

        function createAddButton() {
          var addButton = document.createElement('a');
          addButton.className = 'pure-button';
          addButton.appendChild(document.createTextNode('Add Base'));
          return addButton;
        }

        function createBase() {
          var container = createContainer();

          var labelWrapper = createWrapper();
          labelWrapper.appendChild(createLabelInput());
          container.appendChild(labelWrapper);

          var timeWrapper = createWrapper();
          container.appendChild(timeWrapper);
          timeWrapper.appendChild(createTimeInput());

          return container;
        }

        var baseList = $(".base-list");
        baseList.after(function() {
          var container = createContainer();
          var wrapper = createWrapper();
          container.appendChild(wrapper);
          var addButton = createAddButton();
          wrapper.appendChild(addButton);

          $(addButton).click(function(event) {
            event.preventDefault();
            var newBase = createBase();
            baseList.append(newBase);
            newBase.getElementsByTagName("input")[0].focus();
          });

          return container;
        });
      });
    </script>
  </head>
  <body>
    <div id="layout">
      <h1>Team Timings</h1>
      <form class="pure-form pure-form-stacked team-timings" action="/" method="post">
        <fieldset>
          <legend>Settings</legend>

          <div class="pure-g">
            <div class="pure-u-1">
              <label for="startTime">Start time</label>
              <input type="time" id="startTime" name="startTime" placeholder="08:00" pattern="(\d\d:)?\d\d:\d\d" required>
            </div>

            <div class="pure-u-1">
              <label for="timeBetweenTeams">Time between teams</label>
              <input type="text" id="timeBetweenTeams" name="timeBetweenTeams" placeholder="0:10:00" pattern="(\d+:)?\d\d?:\d\d" required>
            </div>

            <div class="pure-u-1">
              <label for="directions">Directions</label>
              <select id="directions" name="directions" required>
                <option value=""></option>
                <option value="2">2-way</option>
                <option value="1">1-way</option>
              </select>
            </div>

            <div class="pure-u-1">
              <label for="teamCount">Number of teams</label>
              <input type="number" id="teamCount" name="teamCount" min="1" step="1" placeholder="20" required>
            </div>

            <div class="pure-u-1">
              <label for="baseDuration">Time at each base</label>
              <input type="text" id="baseDuration" name="baseDuration" placeholder="0:20:00" pattern="(\d+:)?\d\d?:\d\d" required>
            </div>
          </div>

          <div class="base-list">
            <div class="pure-g">
              <div class="pure-u-1-2 pure-u-md-1-4">
                <label class="pure-input-1">Base Label</label>
              </div>
              <div class="pure-u-1-2 pure-u-md-1-4">
                <label>Time to next base</label>
              </div>
            </div>

            <div class="pure-g">
              <div class="pure-u-1-2 pure-u-md-1-4">
                <input class="pure-input-1" type="text" name="" value="HQ" readonly>
              </div>
              <div class="pure-u-1-2 pure-u-md-1-4">
                <input class="pure-input-1-2" type="text" name="journeyTimes[]" placeholder="0:25:00" pattern="(\d+:)?\d\d?:\d\d" required>
              </div>
            </div>
          </div>

          <div class="pure-controls">
            <button type="submit" class="pure-button pure-button-primary">Submit</button>
          </div>
        </fieldset>
      </form>
    </div>
  </body>
</html>
